!function(e){if(e.ymusicInitialized)return;e.ymusicInitialized=!0;var t="ytmusic-menu-service-item-renderer, paper-dialog { display: none; visibility: invisible; }",n=e.head||e.getElementsByTagName("head")[0],i=e.createElement("style");function o(e){var t=e(),n=!1;for(let e=0;e<t.length;e++){const i=t[e];i&&(i.parentNode.removeChild(i),console.log("Removed "+i.tagName),n=!0)}n||setTimeout(()=>o(e),100)}n.appendChild(i),i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(e.createTextNode(t)),function t(){var n=e.getElementById("left-content");n?(n.innerHTML='<a class="style-scope ytmusic-nav-bar" href="#" aria-label="Trang chá»§">\n<picture class="style-scope ytmusic-nav-bar">\n<svg style="width:24px;height:24px" viewBox="0 0 24 24">\n<path style="fill: white" fill="#ffffffff" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"></path>\n</svg>\n</picture>\n</a>',n.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),console.log("ymusic_open_nav:{}")})):setTimeout(t,100)}(),function t(){let n=e.getElementsByTagName("ytmusic-settings-button");if(n.length&&n[0]&&n[0].accountService_&&n[0].accountService_.cachedGetAccountMenuRequestPromise&&n[0].accountService_.cachedGetAccountMenuRequestPromise.result_&&"SUCCESS"===n[0].accountService_.cachedGetAccountMenuRequestPromise.result_.code){let e=n[0].accountService_.cachedGetAccountMenuRequestPromise.result_.data.actions,t=[];for(let n=0;n<e.length;n++){const i=e[n];if(i.openPopupAction){t=i.openPopupAction.popup.multiPageMenuRenderer.sections;break}}if(t.length){for(t[0].multiPageMenuSectionRenderer.items=t[0].multiPageMenuSectionRenderer.items.filter(e=>{let t=e.compactLinkRenderer.icon.iconType;return"ACCOUNT_BOX"===t||"SWITCH_ACCOUNTS"===t||"EXIT_TO_APP"===t});t.length>1;)t.pop();return}}if("undefined"!=typeof yt&&yt&&yt.config_&&!yt.config_.LOGGED_IN&&(n=e.getElementById("right-content"))){n=n.getElementsByTagName("paper-icon-button");for(let e=0;e<n.length;e++)n[e].hidden=!0}setTimeout(t,100)}(),o(()=>e.getElementsByTagName("ytmusic-player-page")),o(()=>e.getElementsByClassName("fullscreen-overlay")),o(()=>[e.getElementById("player-bar-background")]),o(()=>e.getElementsByTagName("ytmusic-player-bar"));var r,a,s=null;function l(){if(!s)return;console.log("Reset player");var t=100;[()=>{s.store.dispatch({type:"SET_IS_GENERATING",payload:!1})},()=>{s.store.dispatch({type:"SET_PLAYER_PAGE_INFO",payload:{open:!1}})},()=>{s.store.dispatch({type:"SET_PLAYER_UI_STATE",payload:"HIDDEN"})},()=>{s.store.dispatch({type:"CLEAR"})},()=>{s.store.dispatch({type:"SET_PLAYER_UI_STATE",payload:"HIDDEN"})},()=>{s.playerApi&&s.playerApi.stopVideo&&s.playerApi.stopVideo()}].forEach(e=>{setTimeout(e,t),t+=100}),setTimeout(()=>{let t=e.getElementsByTagName("ytmusic-play-button-renderer");for(let e=0;e<t.length;e++){t[e].setAttribute("state","default")}},3e3)}!function t(){let n=e.getElementsByTagName("ytmusic-app-layout"),i=n.length?n[0].playerUiService_:null;var o;i&&!i.mockedStore&&i.store&&i.store.dispatch?(i.mockedStore=!0,o=i.store.dispatch,i.store.dispatch=function(e){if(console.log(e),!e||!e.type)return;let t=e.type,n=e.payload;"SET_PLAYER_UI_STATE"===t&&"INACTIVE"!==n||"SET_PLAYER_PAGE_INFO"===t&&n&&n.open||o.call(i.store,e)},s=i):setTimeout(t,100)}(),r=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(e,t,n,i,o){this._url=t,r.call(this,e,t,n,i,o)},a=XMLHttpRequest.prototype.addEventListener,XMLHttpRequest.prototype.addEventListener=function(e,t){let n=this;a.call(n,e,()=>{n._url&&(n._url.indexOf("/youtubei/v1/next")>-1||n._url.indexOf("/get_video_info")>-1||n._url.indexOf("/get_queue")>-1||n._url.indexOf("/get_share_panel")>-1)||t.call(n)})};const c="ymusic_watch:";function u(e,t,n){console.log(c+JSON.stringify({videoId:e,playlistId:t,shuffle:null!=n&&n}))}var p;p=XMLHttpRequest.prototype.send,XMLHttpRequest.prototype.send=function(e){let t=this,n=this.onreadystatechange;if(this.onreadystatechange=function(){if(t._waitForRadioMyMix){if(4===t.readyState){if(200===t.status)try{let e=JSON.parse(t.responseText).currentVideoEndpoint.watchEndpoint;e.videoId&&e.playlistId&&u(e.videoId,e.playlistId,t._shuffle)}catch(e){}l()}}else if(t._waitForShare){if(4===t.readyState&&200===t.status)try{let e=JSON.parse(t.responseText).actions[0].openPopupAction.popup.unifiedSharePanelRenderer.contents[0].thirdPartyNetworkSection.copyLinkContainer.copyLinkRenderer.shortUrl;console.log("ymusic_share:"+e)}catch(e){}}else n&&n.call(t)},t._url&&t._url.indexOf("/get_share_panel")>-1&&(t._waitForShare=!0),t._url&&(t._url.indexOf("/get_video_info")>-1||t._url.indexOf("/get_queue")>-1))setTimeout(l,500);else{if(t._url&&t._url.indexOf("/youtubei/v1/next")>-1){let n=JSON.parse(e);console.log(n);let i="string"==typeof n.params&&n.params.indexOf("wAEB8gECGAE")>-1;t._shuffle=i;let o=n.playlistId,r=n.videoId;if(r)return setTimeout(l,500),u(r,o,i);if(0===o.indexOf("RDMM")&&15===o.length)return setTimeout(l,500),u(o.substring(4),o,i);if(0===o.indexOf("RDAMVM")&&17===o.length)return setTimeout(l,500),u(o.substring(6),o,i);let a="RDMM"===o,s=0===o.indexOf("RD")&&26===o.length,c=0===o.indexOf("ML");if(!(a||s||c||"LM"===o))return setTimeout(l,500),u(null,o,i);t._waitForRadioMyMix=!0}if(p.call(this,e),t._waitForShare)throw 1}}}(document);